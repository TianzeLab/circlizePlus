<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using ggplot2 feature to write readable R code for circular visualization • circlizePlus</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Using ggplot2 feature to write readable R code for circular visualization">
<meta name="description" content="circlizePlus is a wrapper for circlize. All components are based on classes and objects. Users can use the addition symbol (+) to combine components for a circular visualization with ggplot2 style.">
<meta property="og:description" content="circlizePlus is a wrapper for circlize. All components are based on classes and objects. Users can use the addition symbol (+) to combine components for a circular visualization with ggplot2 style.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">circlizePlus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TianzeLab/circlizePlus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level2">
<h2 id="highlights">Highlights<a class="anchor" aria-label="anchor" href="#highlights"></a>
</h2>
<ul>
<li>Programming in circlizePlus is summarized into 5 addition rules, which are simple and clear.</li>
<li>Like ggplot2, it makes programming circular visualizations in the form of addition of plotting functions.</li>
<li>In ggplot2, the data parameter of the function that draws geometric figures can be missing, and it will use the data parameter value in the ggplot() function. circlizePlus implements similar functionality. In circlizePlus, the function that draws geometric figures can get the default coordinate data (such as x, y) from the track it belongs to.</li>
<li>Like ggplot2, it supports data mapping. The coordinate parameters are mapped to the default values ​​by passing in an anonymous function of the form “function(x,y){…}”.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>It is recommended that you have the latest version of the R environment installed. You need to install devtools and load it into the R environment, and then you can install circlizePlus from Github.</p>
<p><code>install.packages("devtools")</code></p>
<p><code><a href="https://devtools.r-lib.org/" class="external-link">library(devtools)</a></code></p>
<p><code>install_github("TianzeLab/circlizePlus")</code></p>
<p>Every time you reboot the R environment, you need to load circlizePlus again.</p>
<p><code><a href="https://github.com/TianzeLab/circlizePlus" class="external-link">library(circlizePlus)</a></code></p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>We are grateful to Dr. Zuguang Gu from DFKZ for his invaluable guidance and support throughout the project.</p>
</div>
<div class="section level2">
<h2 id="sample-code">Sample code<a class="anchor" aria-label="anchor" href="#sample-code"></a>
</h2>
<p><a href="https://github.com/jokergoo" class="external-link">Dr. Gu</a> has written a book(<a href="https://jokergoo.github.io/circlize_book/book/" class="external-link">“Circular Visualization in R”</a>) explaining how circlize works. To illustrate the similarities and differences between circlize and cirzelizePlus, we’ve rewritten the code in the book as sample code. Visit <a href="https://tianzelab.github.io/circlizePlusBook/">circlizePlusBook</a> for details.</p>
</div>
<div class="section level2">
<h2 id="addition-rules">Addition rules<a class="anchor" aria-label="anchor" href="#addition-rules"></a>
</h2>
<p>ccPlot(contain n ccPars) + 𝑐𝑐𝑃𝑎𝑟 = 𝑐𝑐𝑃𝑙𝑜𝑡(contain 𝑛 + 1 𝑐𝑐𝑃𝑎𝑟𝑠), 𝑛 ≥ 0<br>
ccPlot(contain n ccTracks) + 𝑐𝑐𝑇𝑟𝑎𝑐𝑘 = 𝑐𝑐𝑃𝑙𝑜𝑡(contain 𝑛 + 1 𝑐𝑐𝑇𝑟𝑎𝑐𝑘𝑠), 𝑛 ≥ 0<br>
ccPlot(contain n ccLinks) + 𝑐𝑐𝐿𝑖𝑛𝑘 = 𝑐𝑐𝑃𝑙𝑜𝑡(𝑐𝑜𝑛𝑡𝑎𝑖𝑛 𝑛 + 1 𝑐𝑐𝐿𝑖𝑛𝑘𝑠), 𝑛 ≥ 0<br>
ccTrak(contain n ccTrakGeoms) + 𝑐𝑐𝑇𝑟𝑎𝑐𝑘𝐺𝑒𝑜𝑚 = 𝑐𝑐𝑇𝑟𝑎𝑐𝑘(𝑐𝑜𝑛𝑡𝑎𝑖𝑛 𝑛 + 1 𝑐𝑐𝑇𝑟𝑎𝑐𝑘𝐺𝑒𝑜𝑚𝑠), 𝑛 ≥ 0<br>
ccTrack(contain n ccCells) + 𝑐𝑐𝐶𝑒𝑙𝑙 = 𝑐𝑐𝑇𝑟𝑎𝑐𝑘(𝑐𝑜𝑛𝑡𝑎𝑖𝑛 𝑛 + 1 𝑐𝑐𝐶𝑒𝑙𝑙𝑠), 𝑛 ≥ 0<br>
ccCell(contain n ccCellGeoms) + 𝑐𝑐𝐶𝑒𝑙𝑙𝐺𝑒𝑜𝑚 = 𝑐𝑐𝐶𝑒𝑙𝑙(𝑐𝑜𝑛𝑡𝑎𝑖𝑛 𝑛 + 1 𝑐𝑐𝐶𝑒𝑙𝑙𝐺𝑒𝑜𝑚𝑠), 𝑛 ≥ 0</p>
</div>
<div class="section level2">
<h2 id="s4-class-cccell-and-cccells">S4 class ccCell and ccCells<a class="anchor" aria-label="anchor" href="#s4-class-cccell-and-cccells"></a>
</h2>
<ul>
<li>ccCell: Generate a cell container that belongs to a particular sector.</li>
<li>ccCells: A list of multiple <code>ccCell</code>. Any <code>ccCellGeom</code> and <code>ccCells</code> are added together as if they were added to each <code>ccCell</code> contained in the <code>ccCells</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="data-mapping-from-cctrack-to-ccgenomiccellgeom">Data mapping from ccTrack to ccGenomicCellGeom<a class="anchor" aria-label="anchor" href="#data-mapping-from-cctrack-to-ccgenomiccellgeom"></a>
</h2>
<table class="table">
<colgroup>
<col width="21%">
<col width="9%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="5%">
<col width="14%">
<col width="7%">
</colgroup>
<tbody>
<tr class="odd">
<td>ccTrack Constructor</td>
<td>ccGenomicTrack()</td>
<td>ccGenomicTrack()</td>
<td>ccGenomicTrack()</td>
<td>ccGenomicTrack()</td>
<td>ccTrack()</td>
<td>ccTrack()</td>
<td>ccTrack()</td>
<td>ccTrack()</td>
<td>ccTrack()</td>
<td>ccTrack()</td>
</tr>
<tr class="even">
<td>Parameters in ccTrack Constructor</td>
<td>data</td>
<td>data</td>
<td>data</td>
<td>data</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
</tr>
<tr class="odd">
<td>ccCellGeom Constructor</td>
<td>ccGenomicPoints()</td>
<td>ccGenomicLines()</td>
<td>ccGenomicRect()</td>
<td>ccGenomicText()</td>
<td>ccLines()</td>
<td>ccPoints()</td>
<td>ccPolygon()</td>
<td>ccText()</td>
<td>ccRect()</td>
<td>ccSegments()</td>
</tr>
<tr class="even">
<td>Parameters in ccCellGeom Constructor</td>
<td>region, value</td>
<td>region, value</td>
<td>region, value</td>
<td>region, value</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
<td>x, y</td>
<td>xleft, ybottom, xright, ytop</td>
<td>x0, y0, x1, y1</td>
</tr>
</tbody>
</table>
<p>A combination of each column in the table above:</p>
<div class="section level3">
<h3 id="get-track-from-ccgenomictrack">Get track from ccGenomicTrack()<a class="anchor" aria-label="anchor" href="#get-track-from-ccgenomictrack"></a>
</h3>
<p><code>region</code> and <code>value</code> in ccGenomicCellGeom constructor can be <code>NULL</code> or function like <code>function(region,value){...}</code>. The above data can be obtained from the <code>data</code> parameter of <code>ccGenomicTrack</code>.</p>
<p>In the following example code, the <code>region</code> and <code>value</code> in the <code>ccGenomicLines</code> constructor are <code>NULL</code>. Their real data comes from the <code>data</code> value of the corresponding sector in <code>ccGenomicTrack</code>. The <code>region</code> and <code>value</code> in the <code>ccGenomicPoints</code> constructor are <code>function</code>. Their real data is calculated based on the definition of the function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu">generateRandomBed</span><span class="op">(</span>nr <span class="op">=</span><span class="fl">30</span>, nc <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">all_chr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>,<span class="st">"chr2"</span>,<span class="st">"chr3"</span>,<span class="st">"chr4"</span>,<span class="st">"chr5"</span>,<span class="st">"chr6"</span>,<span class="st">"chr7"</span>,<span class="st">"chr8"</span>,<span class="st">"chr9"</span>,<span class="st">"chr10"</span>,<span class="st">"chr11"</span>,<span class="st">"chr12"</span>,<span class="st">"chr13"</span>,<span class="st">"chr14"</span>,<span class="st">"chr15"</span>,<span class="st">"chr16"</span>,<span class="st">"chr17"</span>,<span class="st">"chr18"</span>,<span class="st">"chr19"</span>,<span class="st">"chr20"</span>,<span class="st">"chr21"</span>,<span class="st">"chr22"</span>,<span class="st">"chrX"</span>,<span class="st">"chrY"</span><span class="op">)</span></span>
<span><span class="va">cc</span> <span class="op">=</span> <span class="fu">ccPlot</span><span class="op">(</span>initMode <span class="op">=</span> <span class="st">"initializeWithIdeogram"</span>, plotType<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">=</span> <span class="fu"><a href="reference/ccGenomicTrack.html">ccGenomicTrack</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span>, numeric.column <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    panel.fun<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">region</span>,<span class="va">value</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>                      <span class="fu">circos.genomicPoints</span><span class="op">(</span><span class="va">region</span>,<span class="va">value</span>,<span class="va">...</span><span class="op">)</span></span>
<span>                    <span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cells1</span> <span class="op">=</span> <span class="fu">ccCells</span><span class="op">(</span>sector.indexes <span class="op">=</span> <span class="va">all_chr</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/ccGenomicLines.html">ccGenomicLines</a></span><span class="op">(</span>numeric.column<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/ccGenomicPoints.html">ccGenomicPoints</a></span><span class="op">(</span>region<span class="op">=</span>\<span class="op">(</span><span class="va">region</span>,<span class="va">value</span><span class="op">)</span><span class="op">{</span><span class="va">region</span><span class="op">}</span>, value<span class="op">=</span>\<span class="op">(</span><span class="va">region</span>,<span class="va">value</span><span class="op">)</span><span class="op">{</span><span class="va">value</span><span class="op">}</span>, numeric.column<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">=</span> <span class="va">t1</span> <span class="op">+</span> <span class="va">cells1</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">cc</span><span class="op">+</span><span class="va">t1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-track-from-cctrack">Get track from ccTrack()<a class="anchor" aria-label="anchor" href="#get-track-from-cctrack"></a>
</h3>
<p><code>x</code>, <code>x0</code>, <code>x1</code>, <code>xleft</code>, <code>xright</code>, <code>y</code>, <code>y0</code>, <code>y1</code>, <code>ytop</code>, <code>ybottom</code> in ccCellGeom constructor can be <code>NULL</code> or function like <code>function(x,y){...}</code>. The above data can be obtained from the <code>x</code> and <code>y</code> parameter of <code>ccTrack</code>.</p>
<p>In the following example code, the <code>x</code> and <code>y</code> in the first <code>ccPoints</code> constructor are <code>NULL</code>. Their real data comes from the <code>x</code> and <code>y</code> of the corresponding sector in <code>ccTrack</code>. The <code>y</code> in the second <code>ccPoints</code> constructor are <code>function</code>. Their real data is calculated based on the definition of the function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sectors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>,<span class="st">'a'</span>,<span class="st">'a'</span>,<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'b'</span>,<span class="st">'b'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>,<span class="st">'d'</span>,<span class="st">'d'</span>,<span class="st">'d'</span>,<span class="st">'d'</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cc</span> <span class="op">=</span> <span class="fu">ccPlot</span><span class="op">(</span>initMode <span class="op">=</span> <span class="st">"initialize"</span>, sectors <span class="op">=</span> <span class="va">sectors</span>, x <span class="op">=</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="va">cells</span> <span class="op">=</span> <span class="fu">ccCells</span><span class="op">(</span>sector.indexes <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">cc_point</span> <span class="op">=</span> <span class="fu"><a href="reference/ccPoints.html">ccPoints</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cells</span> <span class="op">=</span> <span class="va">cells</span> <span class="op">+</span> <span class="va">cc_point</span> <span class="op">+</span> <span class="fu"><a href="reference/ccLines.html">ccLines</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">track1</span> <span class="op">=</span> <span class="fu"><a href="reference/ccTrack.html">ccTrack</a></span><span class="op">(</span>sectors <span class="op">=</span> <span class="va">sectors</span>, x<span class="op">=</span><span class="va">x1</span>, y <span class="op">=</span> <span class="va">y1</span>,panel.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">circos.points</span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">cell_single</span> <span class="op">=</span> <span class="fu">ccCell</span><span class="op">(</span>sector.index <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/ccPoints.html">ccPoints</a></span><span class="op">(</span>y<span class="op">=</span>\<span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">-</span><span class="va">y</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">track1</span> <span class="op">=</span> <span class="va">track1</span> <span class="op">+</span> <span class="va">cells</span> <span class="op">+</span> <span class="va">cell_single</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">cc</span>  <span class="op">+</span> <span class="va">track1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/TianzeLab/circlizePlus/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/TianzeLab/circlizePlus/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing circlizePlus</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tianze Cao <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4308-1878" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Zheyu Zhang <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tianze Cao, Zheyu Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
